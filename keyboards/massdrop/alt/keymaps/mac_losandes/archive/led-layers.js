const {
  k,
  e,
  _____,
  ______,
  makeLayer
} = require('./led-maps.js')

// complete keymap
// [
//     k.esc , k.n1  , k.n2  , k.n3  , k.n4  , k.n5  , k.n6  , k.n7  , k.n8  , k.n9  , k.n0  , k.dash, k.eqal, k.bksp, k.del ,
//     k.tab , k.q   , k.w   , k.e   , k.r   , k.t   , k.y   , k.u   , k.i   , k.o   , k.p   , k.obrk, k.cbrk, k.bslh, k.home,
//     k.caps, k.a   , k.s   , k.d   , k.f   , k.g   , k.h   , k.j   , k.k   , k.l   , k.coln, k.quot,     k.entr    , k.pgup,
//     k.lshf, k.z   , k.x   , k.c   , k.v   , k.b   , k.n   , k.m   , k.comm, k.perd, k.fslh,     k.rshf    , k.arru, k.pgdn,
//     k.lfn , k.lalt, k.lcmd,                    k.spce,                     k.rcmd, k.rfn  ,         k.arrl, k.arrd, k.arrr,
// ]

// empty keymap
// [
//   ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
//   ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
//   ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,     ______    , ______,
//   ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,    ______     , ______, ______,
//   ______, ______, ______,                    ______,                    ______, ______  ,         ______, ______, ______,
// ]

// edges
// [
//          e.n01, e.n02, e.n03, e.n04, e.n05, e.n06, e.n07, e.n08, e.n09, e.n10, e.n11, e.n12, e.n13,
//   e.n14,                                                                                            e.n15,
//   e.n16,                                                                                            e.n17,
//   e.n18,                                                                                            e.n19,
//   e.n20,                                                                                            e.n21,
//   e.n22,                                                                                            e.n23,
//   e.n24, e.n25, e.n26, e.n27, e.n28, e.n29, e.n30, e.n31, e.n32, e.n33, e.n34, e.n35, e.n36, e.n37, e.n39
// ]

const layers = [
  // LAYER 0
  // ==========================================================================
  {
    layer: 0,
    comment: 'Default Layer',
    configs: [{  comment: 'vim mode',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 127, g: 0, b: 255 },
      keys: [
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, k.h   , k.j   , k.k   , k.l   , ______, ______,     ______    , ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,    ______     , ______, ______,
        ______, ______, ______,                    ______,                    ______, ______  ,         ______, ______, ______,
      ]
    }]
  },
  // LAYER 1
  // ==========================================================================
  {
    layer: 1,
    comment: 'LEDs & Fns',
    remainder: {
      comment: 'off MO(1)',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 0, g: 0, b: 0 },
    },
    configs: [{
      comment: 'led preview (edges)', // this one needs to be first
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_USE_ROTATE_PATTERN',
      edges: [
               e.n01, e.n02, e.n03, e.n04, e.n05, e.n06, e.n07, e.n08, e.n09, e.n10, e.n11, e.n12, e.n13,
        e.n14,                                                                                            e.n15,
        e.n16,                                                                                            e.n17,
        e.n18,                                                                                            e.n19,
        e.n20,                                                                                            e.n21,
        e.n22,                                                                                            e.n23,
        e.n24, e.n25, e.n26, e.n27, e.n28, e.n29, e.n30, e.n31, e.n32, e.n33, e.n34, e.n35, e.n36, e.n37, e.n39
      ]
    }, {
      comment: 'led controls',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_PATTERN',
      patternId: 0,
      keys: [
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, k.a   , ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,     ______    , ______,
        ______, ______, k.x   , ______, ______, ______, ______, ______, ______, ______, ______,    ______     , k.arru, k.pgdn,
        ______, ______, ______,                    ______,                    ______, ______  ,         ______, k.arrd, ______,
      ]
    }, {
      comment: 'red delete',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 255, g: 0, b: 0 },
      keys: [
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, k.bksp, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,     ______    , ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,    ______     , ______, ______,
        ______, ______, ______,                    ______,                    ______, ______  ,         ______, ______, ______,
      ]
    }, {
      comment: 'blue power',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 0, g: 0, b: 255 },
      keys: [
        k.esc , ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, k.del ,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,     ______    , ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,    ______     , ______, ______,
        ______, ______, ______,                    ______,                    ______, ______  ,         ______, ______, ______,
      ]
    }, {
      comment: 'purple MO(1)',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 127, g: 0, b: 255 },
      keys: [
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,     ______    , ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,    ______     , ______, ______,
        k.lfn , ______, ______,                    ______,                    ______, ______  ,         ______, ______, ______,
      ]
    }, {
      comment: 'golden F[n] keys',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 255, g: 119, b: 0 },
      keys: [
        ______, k.n1  , k.n2  , k.n3  , k.n4  , k.n5  , k.n6  , k.n7  , k.n8  , k.n9  , k.n0  , k.dash, k.eqal, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,     ______    , ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,    ______     , ______, ______,
        ______, ______, ______,                    ______,                    ______, ______  ,         ______, ______, ______,
      ]
    }]
  }, // /layer 1
  // LAYER 2
  // ==========================================================================
  {
    layer: 2,
    comment: 'Mouse & Media',
    remainder: {
      comment: 'off MO(2)',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 0, g: 0, b: 0 },
    },
    configs: [{
      comment: 'edges, mouse and media keys',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 30, g: 136, b: 230 },
      keys: [
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, k.del ,
        ______, ______, k.w   , ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, k.home,
        k.caps, k.a   , k.s   , k.d   , ______, ______, ______, ______, ______, ______, ______, ______,     ______    , k.pgup,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,    ______     , ______, k.pgup,
        ______, ______, ______,                    k.spce,                    ______, ______  ,         k.arrl, ______, k.arrr,
      ],
      edges: [
               e.n01, e.n02, e.n03, e.n04, e.n05, e.n06, e.n07, e.n08, e.n09, e.n10, e.n11, e.n12, e.n13,
        e.n14,                                                                                            e.n15,
        e.n16,                                                                                            e.n17,
        e.n18,                                                                                            e.n19,
        e.n20,                                                                                            e.n21,
        e.n22,                                                                                            e.n23,
        e.n24, e.n25, e.n26, e.n27, e.n28, e.n29, e.n30, e.n31, e.n32, e.n33, e.n34, e.n35, e.n36, e.n37, e.n39
      ]
    }, {
      comment: 'purple MO(2)',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 127, g: 0, b: 255 },
      keys: [
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,     ______    , ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,    ______     , ______, ______,
        ______, ______, ______,                    ______,                    ______, k.rfn   ,         ______, ______, ______,
      ]
    }]
  }, // /layer 2
  // LAYER 3
  // ==========================================================================
  {
    layer: 3,
    comment: 'App Hotkeys',
    remainder: {
      comment: 'off MO(3)',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 0, g: 0, b: 0 },
    },
    configs: [{
      comment: 'golden App keys',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 255, g: 119, b: 0 },
      keys: [
        ______, k.n1  , k.n2  , k.n3  , k.n4  , ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, k.t   , ______, ______, k.i   , ______, ______, ______, ______, ______, ______,
        ______, ______, k.s   , ______, k.f   , ______, ______, ______, ______, ______, ______, ______,     ______    , ______,
        ______, k.z   , ______, k.c   , ______, k.b   , ______, k.m   , k.comm, ______, ______,    ______     , ______, ______,
        ______, ______, ______,                    ______,                    ______, ______  ,         ______, ______, ______,
      ],
      edges: [
               e.n01, e.n02, e.n03, e.n04, e.n05, e.n06, e.n07, e.n08, e.n09, e.n10, e.n11, e.n12, e.n13,
        e.n14,                                                                                            e.n15,
        e.n16,                                                                                            e.n17,
        e.n18,                                                                                            e.n19,
        e.n20,                                                                                            e.n21,
        e.n22,                                                                                            e.n23,
        e.n24, e.n25, e.n26, e.n27, e.n28, e.n29, e.n30, e.n31, e.n32, e.n33, e.n34, e.n35, e.n36, e.n37, e.n39
      ]
    }, {
      comment: 'purple MO(3)',
      flags: 'LED_FLAG_MATCH_LAYER | LED_FLAG_MATCH_ID | LED_FLAG_USE_RGB',
      rgb: { r: 127, g: 0, b: 255 },
      keys: [
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,     ______    , ______,
        ______, ______, ______, ______, ______, ______, ______, ______, ______, ______, ______,    ______     , ______, ______,
        ______, ______, ______,                    ______,                    k.rcmd, ______  ,         ______, ______, ______,
      ]
    }]
  } // /layer 3
] // /layers

const lb = ',\n'

const layerOutput = layers.map(makeLayer)
  .map((layer, idx) => {
    return `  // Layer ${idx}: ${layer.comment}\n` +
      `  // ========================================================================\n  ` +
      layer.configs.map((made) => {
        if (made.comment) {
          return `// ${made.comment}\n${made.config}`
        } else {
          return made.config
        }
      })
      .join(lb)
      .replace(/\n/g, '\n  ') + lb
  }).join('\n')


console.log(`
led_instruction_t led_instructions[] = {
  //All LEDs use the user's selected pattern (this is the factory default)
  { .flags = LED_FLAG_USE_ROTATE_PATTERN },

${layerOutput}
  //end must be set to 1 to indicate end of instruction set
  { .end = 1 }
};`);
